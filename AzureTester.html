<!DOCTYPE html>
<html>
<head>
    <title>Azure Test Stub</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    <style>
        body {
            margin: 0;
            background: url('logo.png');
            background-repeat: no-repeat;
            background-position: 2% 2%;
            background-size: auto auto;
        }

        .header {
            padding: 20px;
            text-align: center;
        }

        .footer {
            padding: 10px;
            text-align: center;
        }

        .leftsection {
            grid-area: left;
            min-width: 20px;
        }

        .mainsection {
            grid-area: main;
            min-width: 400px;
        }

        .rightsection {
            grid-area: right;
            min-width: 20px;
        }

        .bottomsection {
            grid-area: bottom;
        }

        .grid-container {
            display: grid;
            grid-template-areas: 'left main main main main main main right' 'bottom bottom bottom bottom bottom bottom bottom bottom';
            grid-gap: 10px;
            padding: 10px;
        }

            .grid-container > div {
                border: dotted;
            }

        /* Responsive layout collapse left/right section for narrow screen */
        @media screen and (max-width: 1200px) {
            .leftsection {
                display: none;
            }

            .rightsection {
                display: none;
            }
        }

        #controlgrid {
            display: grid;
            grid-template-columns: 3fr 1fr 3fr 3fr 3fr;
            grid-auto-rows: 50px;
            max-width: 600px;
            min-width: 600px;
            padding: 10px
        }

            #controlgrid > div { /*style for direct child div elements */
                background: #FEFEFE;
                /*padding: 1em;*/
            }

                #controlgrid > div:nth-child(odd) { /*every odd div will be darker */
                    background: #F3F3F3;
                    /*padding: 1em;*/
                }

        .blueButton {
            height: 30px;
            width: 120px;
            border-style: none;
            border-radius: 8px;
            background-color: #4488DD;
            color: white;
        }

            .blueButton:hover {
                background-color: #5599FF;
            }

            .blueButton:active {
                background-color: #77BBFF;
            }

        .blueButtonSimulator a {
            border-style: none;
            border-radius: 8px;
            background-color: #4488DD;
            color: white;
            height: 20px;
            width: 120px;
            display: block;
            text-decoration: none;
            text-align: center;
            padding: 5px 0px 5px 0px;
        }

        .blueButtonSimulator a:hover {
            background-color: #5599FF;
        }

        .blueButtonSimulator a:active {
            background-color: #77BBFF;
        }

        .buttonsimcontainer {
            padding: 10px 5px 0 10px;
            /*padding-bottom: 10px;*/
            justify-content: flex-start;
        }

        .buttoncontainer, .selectcontainer {
            padding: 10px;
            padding-bottom: 10px;
            justify-content: flex-start;
        }

    .radiogroupcontainer {
    justify-content: flex-start;
    }

    /* The radio button container */
    .radiocontainer {
    display: inline-block;
    position: relative;
    padding-left: 30px;
    padding-right: 30px;
    /*margin-bottom: 12px;*/
    cursor: pointer;
    font-size: 14px;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    top: 10px;
    left: 10px;
    /*padding: 10px;*/
    /*padding: 10px;*/
    justify-content: flex-start;
    }

    /* Hide the browser's default radio button */
    .radiocontainer input {
    position: absolute;
    opacity: 0;
    cursor: pointer;
    }

    /* Create a custom radio button */
    .checkmark {
    position: absolute;
    top: 0;
    left: 0;
    height: 25px;
    width: 25px;
    background-color: #AFD0FF; /*//#999999;*/
    border-radius: 50%;
    }

    /* On mouse-over, add a lighter grey background color */
    .radiocontainer:hover input ~ .checkmark {
    background-color: #88BBFF; /*#AAAAAA;*/
    }

    /* When the radio button is checked, add a blue background */
    .radiocontainer input:checked ~ .checkmark {
    background-color: #4488DD;
    }

    /* Create the indicator (the dot/circle - hidden when not checked) */
    .checkmark:after {
    content: "";
    position: absolute;
    display: none;
    }

    /* Show the indicator (dot/circle) when checked */
    .radiocontainer input:checked ~ .checkmark:after {
    display: block;
    }


    /* Style the indicator (dot/circle) */
    .radiocontainer .checkmark:after {
    top: 9px;
    left: 9px;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: yellow;
    }

    a {
    color: #66AAFF;
    }

    a:hover {
    color: #dddddd;
    }

    .subheading {
    font-size: larger;
    font-weight: bold;
    }

    .sectionheading {
    font-size: larger;
    color: purple;
    }

    #errormsg{
         color:red;
     }

    </style>
</head>
<body onLoad="JavaScript:setOnRefresh();">
    <header class="header">
        <h1>Azure Cloud Test Stub</h1>
        <p>Testing the Azure functions and services for connection and response.</p>
    </header>

    <div class="grid-container">
        <div class="leftsection"></div>
        <div class="mainsection">

            <div>
                <section id="textcontent">
                    <p>
                        Intro to use of Azure functions and services.<br />
                        Message about CORS settings.<br />
                    </p>
                    <p>
                        fdgdfgfdgfdg.
                    </p>
                    <p><span id="errormsg"></span></p>
                    <div>
                        <span class="subheading">Settings:</span>
                    </div>
                </section>

                <div id="controlgrid">
                    <div>
                        <p class="sectionheading">RPC Method:</p>
                    </div>
                    <div></div>
                    <div class="radiogroupcontainer">
                        <label class="radiocontainer">
                            Azure JS Fn.
                            <input type="radio" id="js" checked="checked" name="rpctype">
                            <span class="checkmark"></span>
                        </label>
                    </div>
                    <div class="radiogroupcontainer">
                        <label class="radiocontainer">
                            Azure C# Fn.
                            <input type="radio" id="cs" name="rpctype">
                            <span class="checkmark"></span>
                        </label>
                    </div>
                    <div class="radiogroupcontainer">
                        <label class="radiocontainer">
                            WCF Svc.
                            <input type="radio" id="ws" name="rpctype">
                            <span class="checkmark"></span>
                        </label>
                    </div>
                    <div>
                        <p class="sectionheading">Function Params:</p>
                    </div>
                    <div></div>
                    <div class="selectcontainer">Multiple: <select class="select" required id="ddlMultiple"></select></div>
                    <div class="selectcontainer">Modulus: <select class="select" required id="ddlModulus"></select></div>
                    <div class="selectcontainer">Radius: <select class="select" required id="ddlRadius"></select></div>
                    <div>
                        <p class="sectionheading">Function Name:</p>
                    </div>
                    <div></div>
                    <div class="radiogroupcontainer">
                        <label class="radiocontainer">
                            createCoords.
                            <input type="radio" id="defaultMeth" checked="checked" name="methodname">
                            <span class="checkmark"></span>
                        </label>
                    </div>
                    <div class="radiogroupcontainer">
                        <label class="radiocontainer">
                            createMatrix.
                            <input type="radio" name="methodname">
                            <span class="checkmark"></span>
                        </label>
                    </div>
                    <div></div>

                    <div class="buttoncontainer">
                        <input type="button" id="testBut" class="blueButton" value="Test Connection" />
                    </div>
                    <div>
                    </div>
                    <div> todo 200</div>
                    <div class="buttoncontainer">
                        <input type="button" id="resetBut" class="blueButton" value="Reset" />
                    </div>
                    <div class="buttoncontainer">
                        <input type="button" value="Close" class="blueButton" onclick="history.back(-1)" />
                    </div>
                </div>

            </div>
        </div>
        <div class="rightsection"></div>
        <div class="bottomsection"><footer class="footer">footer copyright</footer></div>
    </div>

    <script>
        //set DOM references for HTML elements
        var errormsg = document.getElementById("errormsg");
        var multipleDDL = document.getElementById("ddlMultiple");
        var modulusDDL = document.getElementById("ddlModulus");
        var radiusDDL = document.getElementById("ddlRadius");

        var output1 = document.getElementById("multiplierOut");
        var output2 = document.getElementById("moduloOut");
        var output3 = document.getElementById("radiusOut");

        var radiojs = document.getElementById("js");
        var radiocs = document.getElementById("cs");
        var radiows = document.getElementById("ws");
        var radioDefMeth = document.getElementById("defaultMeth") 
        var anchor = document.getElementById("linkClose");

        //define global variables and initial values
        var querystringObj; //a JSON object to hold query string data

        //call functions to populate dropdowns
        populateMultiple();
        populateModulus();
        populateRadius();

        //reset controls on page refresh
        function setOnRefresh() {
            //obtain data from querystring
            querystringObj = parseQueryString();

            //populate controls using query string params 
            var loadingErrorMsg = populateControls(querystringObj);

            //if we have an error message returned, simply populate control with default values.
            if (loadingErrorMsg != "") {
                errormsg.innerText = loadingErrorMsg;
                resetControlsToStart();
            }
        }

        function populateMultiple() {
            for (var i = 1; i <= 100; i++) {
                var option = document.createElement("OPTION");
                multipleDDL.options.add(option);
                option.text = i;
                option.value = i;
            }
        }

        function populateModulus() {
            for (var i = 1; i <= 200; i++) {
                var option = document.createElement("OPTION");
                modulusDDL.options.add(option);
                option.text = i;
                option.value = i;
            }
        }

        function populateRadius() {
            for (var i = 1; i <= 250; i++) {
                var option = document.createElement("OPTION");
                radiusDDL.options.add(option);
                option.text = i;
                option.value = i;
            }
        }

        function parseQueryString() {

            //obtain data from querystring
            var urlParams = window.location.search
            var strGetQuery = urlParams.split('?')[1]
            
            var params = {}, queries, temp, i, l;
            // Split into key/value pairs
            queries = strGetQuery.split("&");
            // Convert the array of strings into an object
            for (i = 0, l = queries.length; i < l; i++) {
                temp = queries[i].split('=');
                params[temp[0]] = temp[1];
            }
            return params;
        }

        function populateControls(queryObj) {
            var errorstring = "";

            try {
                //basic validation of query string params
                if (Number(queryObj.multiple) < 1 || Number(queryObj.multiple) > 100) {
                    errorstring += "multiple out of range.";
                }
                if (Number(queryObj.modulus) < 1 || Number(queryObj.modulus) > 200) {
                    errorstring += "modulus out of range.";
                }
                if (Number(queryObj.radius) < 100 || Number(queryObj.radius) > 250) {
                    errorstring += "radius out of range.";
                }

                if (isNaN(queryObj.multiple)) {
                    errorstring += "multiple is not a number.";
                }
                if (isNaN(queryObj.modulus)) {
                    errorstring += "modulus is not a number.";
                }
                if (isNaN(queryObj.radius)) {
                    errorstring += "radius is not a number.";
                }

                //populate the RPC radio buttons
                switch (queryObj.rpc) {
                    case "js":
                        radiojs.checked=true;
                        break;
                    case "cs":
                        radiocs.checked = true;
                        break;
                    case "ws":
                        radiows.checked = true;
                        break;
                    default:
                        radiojs.checked = true;
                        errorstring += "RPC method is not valid.";
                }

                //populate controls
                multipleDDL.value = Number(queryObj.multiple);
                modulusDDL.value = queryObj.modulus;
                radiusDDL.value = queryObj.radius;
            }
            catch (err) {
                errormsg.innerText = "error thrown.";
            }
            finally {
                if (errorstring != "" ) {
                    errorstring = "Errors detected in query string. Using defaults to populate screen instead. " + errorstring;
                }
                return errorstring;
            }
        }

        function resetControlsToStart() {
            multipleDDL.value = 1;
            modulusDDL.value = 200;
            radiusDDL.value = 250;
            radiojs.checked = true;
            radioDefMeth.checked = true;
            //errormsg.innerText = "";
        }

    </script>

</body>
</html>